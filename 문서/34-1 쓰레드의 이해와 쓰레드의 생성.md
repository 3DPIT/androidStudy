# 34-1 쓰레드의 이해와 쓰레드의 생성

실행중인 프로그램을 프로세스라고 하고

하나의 프로세스안에서 여러개의 흐름을 가질 수 있게 할 수 있다.

지금까지는 main 문 하나의 흐름을 가지고 있었다.


#### 쓰레드

```
프로세스 내에서 프로그램의 흐름을 만드는 주체, 최소단위를 가리켜 쓰레드라고한다.
```



main()을 실행하기 위한 쓰레드가 자동으로 만들어져 실행하고 있었다.



#### 멀티 쓰레드 

하나의 프로그램 안에 여러개의 쓰레드가 있는것을 말한다.



### 쓰레드 만드는 법

![image-20200617151309224](34-1%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%9D%B4%ED%95%B4%EC%99%80%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%83%9D%EC%84%B1.assets/image-20200617151309224.png)

메인문을 실행하는 쓰레드의 이름은 메인 쓰레드라고 한다.

 ![image-20200617151518552](34-1%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%9D%B4%ED%95%B4%EC%99%80%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%83%9D%EC%84%B1.assets/image-20200617151518552.png)

Runnable 인스턴스 을 구현하는 클래스 를 정의 할수 있는ㄷ

여기선 run 메소드가 생명이다.

왜냐 내가 쓰레드 쓰겠다고 생성을 요청했으면 그 쓰레드가 할 일이 있어야하니까

run 메소드에 쓰레드 할일을 써라. 이런것 이다.



**람다식**

![image-20200617151804492](34-1%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%9D%B4%ED%95%B4%EC%99%80%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%83%9D%EC%84%B1.assets/image-20200617151804492.png)

이게 람다식으로 구현한것 인데 

클래스 정의를 별도로 하고 인스턴스 생성을 각각 구분하는것이 아니고 한번에 하는것



중요한것은

```java
Thread t = new Thread(task); // 스레드 생성하기전 준비 단계
여기서 인스턴스 생성이 쓰레드 생성이라고 오해 하는 면이 있는데
이 부분은 쓰레드 인스턴스만 생성한것이다. 
이래야 자바가상머신인 jvm 이 우리가 이렇게 쓰레드 만들 기반 해놧으니 너가 
쓰레드 생성해서 내가 전달한 run메소드를 실행을 해주는것 

```

#### 쓰레드 생성

t.start(); 이 메소드를 실행을 해야 쓰레드가 생성되고 run 메소드를 실행하는것이다.



**쓰레드 실행 순서**

main메소드 -> t.start()이 생성되는 시점에 

두개의 흐름을 가짐

main 메소드 따로 , t 라는쓰레드 따로 흐름을 가짐 



누가 먼저 끝나는지 정확히 판별을 할 수 없다. 

![image-20200617155153734](34-1%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%9D%B4%ED%95%B4%EC%99%80%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%83%9D%EC%84%B1.assets/image-20200617155153734.png)

```
 여기서는 

t1 쓰레드와  main쓰레드 , t2쓰레드 3개가 돌고 있다.

소스 순서상t1 이 실행되고 t2가 실행되니까

0 1 2 3 4 순서대로 출력이 될수 있지만 그렇게 예측하는대로 안되는 경우가 있다.

```

3개의 쓰레드가 3개의 코어에 동시에 실행되는 과정에 있을때 

이상적인 상황에서는 순서대로 나올 수있는데 

톡 하나프로그램 3개의 프로그램 상황에서는 3개의 코어를 나눠서 쓰게된다.



1번은 톡에게 양보 2번은 1번 한테 

3번은 2번 한테 

톡은 또 남은 애한테 양보를 하는데  이경우가 사실 빨라서 동시에 실행되어 보이는것 

그래서 어느순간 t2가 먼저 실행될 수 있다. 



실행은 되니 무조건 먼저 생성했다고 먼저 끝나는것은 아니다 라는것을 알아야한다.



### 쓰레드를 생성하는 두번째 방법

![image-20200617160109910](34-1%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%9D%B4%ED%95%B4%EC%99%80%20%EC%93%B0%EB%A0%88%EB%93%9C%EC%9D%98%20%EC%83%9D%EC%84%B1.assets/image-20200617160109910.png)

쓰레드를 상속하고 run메소드를 오버라이딩 한것

요새는 왜 runable을쓰는지 람다식이 기반이 훨씬 코드가 간결하기 때문에

차이는 많이 없지만 처음 방법을 많이 쓴다고 한다. 

